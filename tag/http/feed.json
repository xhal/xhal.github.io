{
    "version": "https://jsonfeed.org/version/1",
    "title": "星辰大海 • All posts by \"http\" tag",
    "description": "学习、编程、生活",
    "home_page_url": "http://xsea.cc",
    "items": [
        {
            "id": "http://xsea.cc/2023/04/6f80e107.html",
            "url": "http://xsea.cc/2023/04/6f80e107.html",
            "title": "Centos7.9安装typecho",
            "date_published": "2023-04-11T15:07:31.000Z",
            "content_html": "<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><h1 id=\"centos79安装typecho\"><a class=\"markdownIt-Anchor\" href=\"#centos79安装typecho\">#</a> Centos7.9 安装 typecho</h1>\n<blockquote>\n<p>简介<br>\n环境信息：<br>\n系统： Centos 7.9<br>\nPHP: 8.2.4<br>\nTypecho: 1.2.0</p>\n</blockquote>\n<span id=\"more\"></span>\n<h2 id=\"一-安装php-824环境\"><a class=\"markdownIt-Anchor\" href=\"#一-安装php-824环境\">#</a> 一、安装 PHP (8.2.4) 环境</h2>\n<h3 id=\"安装必要依赖包\"><a class=\"markdownIt-Anchor\" href=\"#安装必要依赖包\">#</a> 安装必要依赖包</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">-y</span> bzip2-devel libcurl-devel libxml2-devel sqlite-devel oniguruma oniguruma-devel libxml2 libxml2-devel <span class=\"token function\">bzip2</span> bzip2-devel libcurl libcurl-devel libjpeg libjpeg-devel zstd libzstd-devel <span class=\"token function\">curl</span> libcurl-devel libpng libpng-devel</pre></td></tr></table></figure><h3 id=\"检查-libzip-版本\"><a class=\"markdownIt-Anchor\" href=\"#检查-libzip-版本\">#</a> 检查 libzip 版本</h3>\n<p>libzip 版本要求：  <code>libzip &gt;= 0.11 libzip != 1.3.1 libzip != 1.7.0... </code></p>\n<p>使用以下命令，查看当前安装版本</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-q</span> libzip</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-q</span> libzip-devel</pre></td></tr></table></figure><p>如果有且版本不符合，卸载</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum remove libzip-devel libzip</pre></td></tr></table></figure><p>重新从官网下载源码并编译安装</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#下载安装</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">wget</span> https://libzip.org/download/libzip-1.3.2.tar.gz</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> libzip-1.3.2.tar.gz</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">cd</span> libzip-1.3.2</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>./configure</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><p>安装完成后，查看是否存在 /usr/local/lib/pkgconfig 目录，如果存在，执行如下命令来设置 PKG_CONFIG_PATH：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">PKG_CONFIG_PATH</span><span class=\"token operator\">=</span><span class=\"token string\">\"/usr/local/lib/pkgconfig/\"</span></pre></td></tr></table></figure><h3 id=\"从官网下载-php-源码包\"><a class=\"markdownIt-Anchor\" href=\"#从官网下载-php-源码包\">#</a> 从官网下载 PHP 源码包</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> https://www.php.net/distributions/php-8.2.4.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 解压</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> php-8.2.4.tar.gz</pre></td></tr></table></figure><h3 id=\"configure-配置及安装\"><a class=\"markdownIt-Anchor\" href=\"#configure-配置及安装\">#</a> ./configure 配置及安装</h3>\n<p>安装目录：  <code>/usr/local/php-8</code></p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">cd</span> php-8.2.4</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 配置</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>./configure <span class=\"token parameter variable\">--prefix</span><span class=\"token operator\">=</span>/usr/local/php-8 --enable-fpm --with-pgsql --with-mysqli --enable-mbstring --with-bz2 --with-curl --enable-gd --with-zip --with-zlib --with-openssl --without-pear  --disable-phar</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># make,  -j 选项用于控制多进程的并发度。-j 指定的是线程的数量，-j2 表示最多启动 2 个线程</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token parameter variable\">-j2</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">make</span> <span class=\"token function\">install</span></pre></td></tr></table></figure><h3 id=\"配置环境变量\"><a class=\"markdownIt-Anchor\" href=\"#配置环境变量\">#</a> 配置环境变量</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#设置环境变量</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">touch</span> /etc/profile.d/php.sh</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">chmod</span> <span class=\"token number\">755</span> /etc/profile.d/php.sh </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">'\\nexport PATH=/usr/local/php-8/bin:$PATH\\n'</span> <span class=\"token operator\">>></span> /etc/profile.d/php.sh</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">source</span> /etc/profile.d/php.sh</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 执行 php -v 查看版本</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>php <span class=\"token parameter variable\">-v</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">>></span> PHP <span class=\"token number\">8.2</span>.4 <span class=\"token punctuation\">(</span>cli<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>built: Apr <span class=\"token number\">11</span> <span class=\"token number\">2023</span> <span class=\"token number\">22</span>:32:28<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>NTS<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token operator\">>></span> Copyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> The PHP Group</pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token operator\">>></span> Zend Engine v4.2.4, Copyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> Zend Technologies</pre></td></tr></table></figure><h3 id=\"复制配置文件到正确的路径\"><a class=\"markdownIt-Anchor\" href=\"#复制配置文件到正确的路径\">#</a> 复制配置文件到正确的路径</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 在源代码目录 php-8.2.4 中下执行以下命令</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> php-8.2.4</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">cp</span> php.ini-production /usr/local/php-8/lib/php.ini</pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">cp</span> /usr/local/php-8/etc/php-fpm.conf.default /usr/local/php-8/etc/php-fpm.conf</pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">cp</span> /usr/local/php-8/etc/php-fpm.d/www.conf.default /usr/local/php-8/etc/php-fpm.d/www.conf</pre></td></tr></table></figure><h3 id=\"配置php-fpm服务开机启动\"><a class=\"markdownIt-Anchor\" href=\"#配置php-fpm服务开机启动\">#</a> 配置 php-fpm 服务，开机启动</h3>\n<p>设置 pid</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 打开 php-fpm.conf</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">vim</span> /usr/local/php-8/etc/php-fpm.conf</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 找到 pid 信息行，并修改为</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pid <span class=\"token operator\">=</span> /var/run/php-fpm.pid</pre></td></tr></table></figure><p>新建 php-fpm.service 文件</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> /usr/lib/systemd/system/php-fpm.service</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>Unit<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token assign-left variable\">Description</span><span class=\"token operator\">=</span>The PHP fpm <span class=\"token function\">service</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token assign-left variable\">After</span><span class=\"token operator\">=</span>syslog.target network.target</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>Service<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token assign-left variable\">Type</span><span class=\"token operator\">=</span>forking</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token assign-left variable\">PIDFile</span><span class=\"token operator\">=</span>/var/run/php-fpm.pid</pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/local/php-8/sbin/php-fpm</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">ExecReload</span><span class=\"token operator\">=</span>/bin/kill <span class=\"token parameter variable\">-USR2</span> <span class=\"token variable\">$MAINPID</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">PrivateTmp</span><span class=\"token operator\">=</span>true</pre></td></tr><tr><td data-num=\"11\"></td><td><pre> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">[</span>Install<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token assign-left variable\">WantedBy</span><span class=\"token operator\">=</span>multi-user.target</pre></td></tr></table></figure><p>serivce 相关命令</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>systemctl <span class=\"token builtin class-name\">enable</span> php-fpm.service    <span class=\"token comment\"># 设置开机启动</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>systemctl disable php-fpm.service   <span class=\"token comment\"># 停止开机启动</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>systemctl start php-fpm.service     <span class=\"token comment\"># 启动服务</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>systemctl stop php-fpm.service      <span class=\"token comment\"># 停止服务</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>systemctl status php-fpm.service    <span class=\"token comment\"># 查看服务状态</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>systemctl restart php-fpm.service   <span class=\"token comment\"># 重启服务</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>systemctl list-units <span class=\"token parameter variable\">--type</span><span class=\"token operator\">=</span>service <span class=\"token comment\"># 查看所有已启动的服务</span></pre></td></tr></table></figure><h2 id=\"二-安装typecho\"><a class=\"markdownIt-Anchor\" href=\"#二-安装typecho\">#</a> 二、安装 typecho</h2>\n",
            "tags": [
                "EncryptedTag",
                "web",
                "http"
            ]
        }
    ]
}