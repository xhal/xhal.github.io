{
    "version": "https://jsonfeed.org/version/1",
    "title": "星辰大海 • All posts by \"centos\" tag",
    "description": "学习、编程、生活",
    "home_page_url": "http://xsea.cc",
    "items": [
        {
            "id": "http://xsea.cc/2023/02/37631c5.html",
            "url": "http://xsea.cc/2023/02/37631c5.html",
            "title": "Linux/Centos 环境Shell会话关闭后，本会话启动进程被终止",
            "date_published": "2023-02-13T13:27:04.000Z",
            "content_html": "<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><blockquote>\n<p>原因排查：Linux/Centos 环境 Shell 会话关闭后，本会话启动进程被终止</p>\n<p>记录下工作中遇到的问题，希望给遇到的小伙伴参考</p>\n</blockquote>\n<span id=\"more\"></span>\n<p>原文链接： <span class=\"exturl\" data-url=\"aHR0cHM6Ly9hc2suY3Nkbi5uZXQvcXVlc3Rpb25zLzc4ODEyOTQvNTQwNjA2OTE=\">Linux/Centos 环境 shell 会话关闭后，java 进程被结束</span></p>\n<h3 id=\"一-操作环境-软件版本等信息\"><a class=\"markdownIt-Anchor\" href=\"#一-操作环境-软件版本等信息\">#</a> 一、操作环境、软件版本等信息</h3>\n<blockquote>\n<p>Centos 7.9.2009</p>\n<p>Java8</p>\n</blockquote>\n<h3 id=\"二-问题场景\"><a class=\"markdownIt-Anchor\" href=\"#二-问题场景\">#</a> 二、问题场景：</h3>\n<blockquote>\n<p>1、 原启动命令  <code>java -jar xxx.jar &gt; test.log 2&gt;&amp;1 &amp;</code>  在  <code>start.sh</code>  脚本文件里</p>\n<p>2、有两台一样的服务器， 环境配置都一样； 之前一直是正常的（shell 会话关闭，也可正常运行）</p>\n<p>3、其中一台重启后，手动上去执行此脚本启动后；会话关闭进程就没了</p>\n</blockquote>\n<h3 id=\"三-尝试过的解决方法\"><a class=\"markdownIt-Anchor\" href=\"#三-尝试过的解决方法\">#</a> 三、尝试过的解决方法</h3>\n<blockquote>\n<p>1、 在命令前增加  <code>nohup</code>  ， 尝试无效</p>\n<p>2、 在命令前增加  <code>nohup</code>  ，并使用 exit 退出 shell 会话， 尝试无效</p>\n<p>3、 检查设置参数 shopt huponexit huponexit 原本值就为 off, 尝试重新设置后， 一样无效</p>\n<p>4、 使用  <code>screen</code>  启动， 尝试无效</p>\n</blockquote>\n<h3 id=\"四-最终排查原因-及-解决方案\"><a class=\"markdownIt-Anchor\" href=\"#四-最终排查原因-及-解决方案\">#</a> 四、最终排查原因 及 解决方案</h3>\n<h4 id=\"问题原因-ssh-版本被更新\"><a class=\"markdownIt-Anchor\" href=\"#问题原因-ssh-版本被更新\">#</a> 问题原因：  <code>SSH</code>  版本被更新</h4>\n<blockquote>\n<p>没问题的服务器 SSH 版本（旧的）： 7.4p1</p>\n<p>有问题的服务器 SSH 版本（新的）： 8.9p1</p>\n</blockquote>\n<h4 id=\"解决方案\"><a class=\"markdownIt-Anchor\" href=\"#解决方案\">#</a> 解决方案：</h4>\n<p>在  <code>ssh@.service</code>  中 [Service] 节点下，添加  <code>KillMode=process</code>  后</p>\n<p>使用命令  <code>systemctl restart sshd.service</code>  重启 sshd 服务</p>\n<p>参考连接：<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vYnl6Z3NzL3AvMTU1NzMzNDQuaHRtbA==\">https://www.cnblogs.com/byzgss/p/15573344.html</span></p>\n",
            "tags": [
                "Linux",
                "Centos",
                "Shell"
            ]
        },
        {
            "id": "http://xsea.cc/2022/05/cd130dc5.html",
            "url": "http://xsea.cc/2022/05/cd130dc5.html",
            "title": "Centos安装Maven私服Nexus3",
            "date_published": "2022-05-06T05:25:30.000Z",
            "content_html": "<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><blockquote>\n<p>记录 Centos 安装 Maven 私服 Nexus3 过程</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"centos-安装-maven私服-nexus3\"><a class=\"markdownIt-Anchor\" href=\"#centos-安装-maven私服-nexus3\">#</a> Centos 安装 Maven 私服 Nexus3</h1>\n<ol>\n<li>\n<p>创建 nexus 用户、设置密码</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@aly-nexus local<span class=\"token punctuation\">]</span><span class=\"token comment\"># adduser nexus</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@aly-nexus local<span class=\"token punctuation\">]</span><span class=\"token comment\"># passwd nexus</span></pre></td></tr></table></figure></li>\n<li>\n<p>以 nexus 用户登陆，上传 Nexus 包、解压至用户根目录</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>nexus@aly-nexus ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> nexus-3.29.2-02-unix.tar.gz</pre></td></tr></table></figure></li>\n<li>\n<p>修改文件描述资源限制</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@aly-nexus local<span class=\"token punctuation\">]</span><span class=\"token comment\"># vim /etc/security/limits.conf</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#@student        -       maxlogins       4</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>*               soft    nofile           <span class=\"token number\">65536</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>*               hard    nofile           <span class=\"token number\">65536</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># End of file</span></pre></td></tr></table></figure></li>\n<li>\n<p>配置开机启动</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@aly-nexus local<span class=\"token punctuation\">]</span><span class=\"token comment\"># vim /etc/rc.local</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#!/bin/bash</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># It is highly advisable to create own systemd services or udev rules</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># to run scripts during boot instead of using this file.</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># In contrast to previous versions due to parallel execution during boot</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># this script will NOT be run after all other services.</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># that this script will be executed during boot.</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">touch</span> /var/lock/subsys/local</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># 以 nexus 用户运行启动 nexus 服务</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token function\">su</span> - nexus <span class=\"token parameter variable\">-c</span> <span class=\"token string\">\"/home/nexus/nexus-3.29.2-02/bin/nexus start\"</span></pre></td></tr></table></figure></li>\n<li>\n<p>以 nexus 用户登陆，手动启动服务</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>nexus@aly-nexus ~<span class=\"token punctuation\">]</span>$ /home/nexus/nexus-3.29.2-02/bin/nexus start</pre></td></tr></table></figure></li>\n</ol>\n<p>启动成功后，访问地址： <span class=\"exturl\" data-url=\"aHR0cDovL3huLS1pcC1mcjVjODZseDd6OjgwODE=\">http:// 服务器 ip:8081</span></p>\n",
            "tags": [
                "Centos",
                "Nexus"
            ]
        },
        {
            "id": "http://xsea.cc/2022/03/cca36461.html",
            "url": "http://xsea.cc/2022/03/cca36461.html",
            "title": "Centos安装Tengine",
            "date_published": "2022-03-22T15:14:56.000Z",
            "content_html": "<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><h1 id=\"centos-安装-tengine\"><a class=\"markdownIt-Anchor\" href=\"#centos-安装-tengine\">#</a> Centos 安装 Tengine</h1>\n<blockquote>\n<p>记录下源码安装 Tengine 过程记录</p>\n</blockquote>\n<ol>\n<li>\n<p>下载及解压包</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">## 进入 /usr/local/ 目录</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@ss-aliyun home<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd /usr/local/</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">## 下载源码包</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@ss-aliyun local<span class=\"token punctuation\">]</span><span class=\"token comment\"># wget http://tengine.taobao.org/download/tengine-2.3.2.tar.gz</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">## 解压</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@ss-aliyun local<span class=\"token punctuation\">]</span><span class=\"token comment\"># tar -zxvf tengine-2.3.2.tar.gz</span></pre></td></tr></table></figure></li>\n<li>\n<p>cd 切换到 Tengine 解压目录</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@ss-aliyun local<span class=\"token punctuation\">]</span><span class=\"token comment\"># cd tengine-2.3.2/</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@ss-aliyun tengine-2.3.2<span class=\"token punctuation\">]</span><span class=\"token comment\">#</span></pre></td></tr></table></figure></li>\n<li>\n<p>配置安装，包含健康检查 check 模块 (默认安装目录  <code> /usr/local/nginx</code> )</p>\n</li>\n</ol>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@ss-aliyun tengine-2.3.2<span class=\"token punctuation\">]</span><span class=\"token comment\"># ./configure --add-module=modules/ngx_http_upstream_check_module</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@ss-aliyun tengine-2.3.2<span class=\"token punctuation\">]</span><span class=\"token comment\"># make</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@ss-aliyun tengine-2.3.2<span class=\"token punctuation\">]</span><span class=\"token comment\"># make install</span></pre></td></tr></table></figure><ol start=\"4\">\n<li>\n<p>开机启动</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@ss-aliyun local<span class=\"token punctuation\">]</span><span class=\"token comment\"># vim /etc/rc.local</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#!/bin/bash</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># It is highly advisable to create own systemd services or udev rules</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># to run scripts during boot instead of using this file.</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\"># In contrast to previous versions due to parallel execution during boot</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># this script will NOT be run after all other services.</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># Please note that you must run 'chmod +x /etc/rc.d/rc.local' to ensure</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># that this script will be executed during boot.</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token function\">touch</span> /var/lock/subsys/local</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\"># 启动 nginx 服务</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>/usr/local/nginx/sbin/nginx</pre></td></tr></table></figure></li>\n<li>\n<p>配置 nginx.conf</p>\n</li>\n</ol>\n<p>PS: 此处删除了 默认 80 端口 静态 html 配置，若需要则在拓展  <code>vhost/</code>  目录下自己添加配置</p>\n<pre><code class=\"language-config\">#user  nobody;\nworker_processes  auto;\n\n#error_log  logs/error.log;\n#error_log  logs/error.log  notice;\n#error_log  logs/error.log  info;\n#error_log  &quot;pipe:rollback logs/error_log interval=1d baknum=7 maxsize=2G&quot;;\n\n#pid        logs/nginx.pid;\n\n\nevents &#123;\n    worker_connections  1024;\n&#125;\n\n\nhttp &#123;\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    charset utf-8;\n\n    #log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '\n    #                  '$status $body_bytes_sent &quot;$http_referer&quot; '\n    #                  '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';\n\n    #access_log  logs/access.log  main;\n    #access_log  &quot;pipe:rollback logs/access_log interval=1d baknum=7 maxsize=2G&quot;  main;\n\n    log_format xformat '$time_local - [$scheme $host] $remote_addr[$request] $status $body_bytes_sent '\n                      '$upstream_addr - $upstream_response_time';\n    access_log  logs/access.log xformat;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    gzip  on;\n\n    include ./vhost/*.conf;\n    \n    #upstream dubbo_backend &#123;\n    #    multi 1;\n    #    server 127.0.0.1:20880;\n    #&#125;\n\n    # another virtual host using mix of IP-, name-, and port-based configuration\n    #\n    #server &#123;\n    #    listen       8000;\n    #    listen       somename:8080;\n    #    server_name  somename  alias  another.alias;\n\n    #    location / &#123;\n    #        root   html;\n    #        index  index.html index.htm;\n    #    &#125;\n    #&#125;\n\n\n    # HTTPS server\n    #\n    #server &#123;\n    #    listen       443 ssl;\n    #    server_name  localhost;\n\n    #    ssl_certificate      cert.pem;\n    #    ssl_certificate_key  cert.key;\n\n    #    ssl_session_cache    shared:SSL:2m;\n    #    ssl_session_timeout  4h;\n\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\n    #    ssl_prefer_server_ciphers  on;\n\n    #    location / &#123;\n    #        root   html;\n    #        index  index.html index.htm;\n    #    &#125;\n    #&#125;\n&#125;\n</code></pre>\n",
            "tags": [
                "Nginx",
                "Centos",
                "Tengine"
            ]
        },
        {
            "id": "http://xsea.cc/2022/03/29184805.html",
            "url": "http://xsea.cc/2022/03/29184805.html",
            "title": "Centos使用yum常用命令",
            "date_published": "2022-03-12T14:21:38.000Z",
            "content_html": "<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><blockquote>\n<p>在部署过程中，经常要使用 yum 命令安装些组件； 记录下常用的命令参数</p>\n</blockquote>\n<span id=\"more\"></span>\n<h3 id=\"清理缓存信息\"><a class=\"markdownIt-Anchor\" href=\"#清理缓存信息\">#</a> 清理缓存信息</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum clean all</pre></td></tr></table></figure><h3 id=\"更新缓存\"><a class=\"markdownIt-Anchor\" href=\"#更新缓存\">#</a> 更新缓存</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum makecache</pre></td></tr></table></figure><h3 id=\"安装包最新版本\"><a class=\"markdownIt-Anchor\" href=\"#安装包最新版本\">#</a> 安装包 (最新版本)</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> 包名（例如： redis）</pre></td></tr></table></figure><h3 id=\"安装包指定版本\"><a class=\"markdownIt-Anchor\" href=\"#安装包指定版本\">#</a> 安装包 (指定版本)</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> 带版本包名（例如： redis-5.1.2.x86_x64）</pre></td></tr></table></figure><h3 id=\"仅下载不安装\"><a class=\"markdownIt-Anchor\" href=\"#仅下载不安装\">#</a> 仅下载（不安装）</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum <span class=\"token function\">install</span> <span class=\"token parameter variable\">--downloadonly</span> 包名（例如： redis）</pre></td></tr></table></figure><blockquote>\n<p>默认情况下，下载的 RPM 包文件存放在以下目录<br>\n /var/cache/yum/x86_64/[system version]/[repository]/packages</p>\n</blockquote>\n<h3 id=\"查找指定包\"><a class=\"markdownIt-Anchor\" href=\"#查找指定包\">#</a> 查找指定包</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum list<span class=\"token operator\">|</span><span class=\"token function\">grep</span> 包名或关键字（例如： redis）</pre></td></tr></table></figure><h3 id=\"卸载指定包\"><a class=\"markdownIt-Anchor\" href=\"#卸载指定包\">#</a> 卸载指定包</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>yum remove 包名（例如： redis）</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">rpm</span> <span class=\"token parameter variable\">-e</span> 包名（例如： redis）</pre></td></tr></table></figure>",
            "tags": [
                "Linux",
                "Centos",
                "Yum"
            ]
        }
    ]
}