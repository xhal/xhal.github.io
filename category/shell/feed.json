{
    "version": "https://jsonfeed.org/version/1",
    "title": "星辰大海 • All posts by \"shell\" category",
    "description": "学习、编程、生活",
    "home_page_url": "http://xsea.cc",
    "items": [
        {
            "id": "http://xsea.cc/2023/03/1e014c62.html",
            "url": "http://xsea.cc/2023/03/1e014c62.html",
            "title": "Windows切换JDK版本（Bat脚本）",
            "date_published": "2023-03-21T06:46:57.000Z",
            "content_html": "<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><blockquote>\n<p>当我们系统中有多个 JDK 版本时，要切换时每次都要手动修改：</p>\n<p>右键打开我的电脑 &gt;&gt; 属性 &gt;&gt; 系统高级设置 &gt;&gt; 环境变量， 修改 JAVA_HOME 的值</p>\n<p>非常麻烦，所以写个脚本，一键搞定；</p>\n</blockquote>\n<p>先来看看效果：</p>\n<p><img data-src=\"https://static.xhal.net/picgo/uTools_1679382309562.png\" alt=\"\"></p>\n<p>我们将 JDK 统一放置在同一个目录下，比如  <code>D:\\Env\\Java</code></p>\n<p>脚本简单实现逻辑，就是将这指定目录下，所有子目录都找出来，并按顺序生成编号</p>\n<p>脚本根据用户输入的编号对应的目录，更新环境变量  <code>JAVA_HOME</code></p>\n<p>脚本内容如下 (<strong>特别注意： 使用 GBK 编码保存脚本文件，否则会中文乱码</strong>)：</p>\n<figure class=\"highlight powershell\"><figcaption data-lang=\"PowerShell\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>@<span class=\"token function\">echo</span> off</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>:: 获取管理员执行权限</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">%</span>1 mshta vbscript:CreateObject<span class=\"token punctuation\">(</span><span class=\"token string\">\"Shell.Application\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ShellExecute<span class=\"token punctuation\">(</span><span class=\"token string\">\"cmd.exe\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"/c %~s0 ::\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"runas\"</span><span class=\"token punctuation\">,</span>1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">)</span>&amp;&amp;<span class=\"token keyword\">exit</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>cd <span class=\"token operator\">/</span>d <span class=\"token string\">\"%~dp0\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>:: 设置容器大小 及 标题</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>mode con cols=120 lines=30</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>title JDK-Version change script of Bat</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>setlocal EnableDelayedExpansion</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>:menu</pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">echo</span> 当前 JDK 版本:</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">echo</span> <span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span><span class=\"token operator\">--</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>java <span class=\"token operator\">-</span>version</pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">echo</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">echo</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token function\">echo</span> ========================================================</pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token function\">echo</span> <span class=\"token comment\">################ JDK 版本切换，可选操作 ################</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token function\">echo</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token function\">echo</span>          <span class=\"token punctuation\">[</span>0<span class=\"token punctuation\">]</span>  取消切换</pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token function\">set</span> <span class=\"token string\">\"options=\"</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token function\">set</span> <span class=\"token string\">\"count=0\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>:: 指定根目录，遍历子文件夹</pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token operator\">/</span>d <span class=\"token operator\">%</span><span class=\"token operator\">%</span>d in <span class=\"token punctuation\">(</span><span class=\"token string\">\"D:\\Env\\Java\\*\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token function\">set</span> <span class=\"token operator\">/</span>a <span class=\"token string\">\"count+=1\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token function\">set</span> <span class=\"token string\">\"options=!options! !count!\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token function\">set</span> <span class=\"token string\">\"dir[!count!]=%%d\"</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>::<span class=\"token function\">echo</span> <span class=\"token function\">Select</span> a directory:</pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token operator\">%</span><span class=\"token operator\">%</span>i in <span class=\"token punctuation\">(</span><span class=\"token operator\">%</span>options%<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token function\">echo</span>          <span class=\"token punctuation\">[</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span>i<span class=\"token punctuation\">]</span>  切换至版本： <span class=\"token operator\">!</span><span class=\"token function\">dir</span><span class=\"token punctuation\">[</span><span class=\"token operator\">%</span><span class=\"token operator\">%</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">!</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token function\">echo</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token function\">echo</span> ========================================================</pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token function\">echo</span><span class=\"token punctuation\">.</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>:tipsChoose</pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token function\">set</span> <span class=\"token operator\">/</span>p <span class=\"token string\">\"choice=Enter the number of your choice: \"</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token string\">\"%choice%\"</span> EQU <span class=\"token string\">\"0\"</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>       goto <span class=\"token keyword\">exit</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token operator\">%</span>choice% gtr <span class=\"token operator\">%</span>count% <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token function\">echo</span> 请输入<span class=\"token punctuation\">[</span> 0 <span class=\"token operator\">--</span> <span class=\"token operator\">%</span>count% <span class=\"token punctuation\">]</span>范围内的数字</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token function\">echo</span> 》》》</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    goto tipsChoose</pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token function\">set</span> <span class=\"token string\">\"JAVA_HOME=!dir[%choice%]!\"</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token string\">\"!JAVA_HOME!\"</span> == <span class=\"token string\">\"\"</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token function\">echo</span> 获取的目录为空，请输入正确范围内的数字！</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    goto tipsChoose</pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>setx JAVA_HOME <span class=\"token string\">\"!JAVA_HOME!\"</span> <span class=\"token operator\">/</span>m</pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token function\">echo</span> JAVA_HOME 已切换至： <span class=\"token operator\">!</span>JAVA_HOME!</pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token function\">echo</span> 按任意键退出<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> &amp; pause > nul</pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>:<span class=\"token keyword\">exit</span></pre></td></tr></table></figure>",
            "tags": [
                "Shell",
                "Windows"
            ]
        }
    ]
}